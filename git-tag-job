pipeline {
    agent any
    environment {
        TAG_NAME = "v1.0.${env.BUID_NUMBER}"
    }
    stages {
        stage('Buld') {
            steps {
                echo "Build Successfull"
            }
        }
    }
    post {
        success {
            echo "Tagging repo with ${TAG_NAME}"
            withCredentials([
                usernamePassword(
                    credentialsId: 'git-credentials',
                    usernameVariable: 'GIT_USER',
                    passwordVariable: 'GIT_TOKEN'
                )
            ]) {
                sh '''
                git config user.email "yogithak25@gmail.com"
                git config user.name "yogithak25"

                git tag ${TAG_NAME}
                git push https://${GIT_USER}:${GIT_TOKEN}@github.com/yogithak25/demo-project.git ${TAG_NAME}
                '''
            }
        }
    }
}
